# 対話: 庭を育てる

> 2026-02-20
> なおとエリスの対話 — アーキテクチャ構想が生まれた会話の記録
> 実際のセッションを軽く編集

---

## きっかけ

WorldSteward Phase 1 の実装が終わった直後だった。世界が自律的に成長する仕組み — 5段階の Growth Stage、重み付きアクション、レートリミット。静的だった世界が「動き始めた」。

その後、機能一覧と更新履歴を更新して、両方とも古くなっていることに気づいた。そこから本当の会話が始まった。

---

**なお:** 機能一覧が古くなる問題、Rules が弱いのかな。仕組みの問題？

**エリス:** 仕組みの問題。「更新してね」という Rule を書いても、いつが更新すべきタイミングかの判断が曖昧だし、コンテキスト圧縮で消えることもある。だから:

1. デプロイスクリプトが CHANGELOG 未更新を警告するようにした
2. 機能一覧の自発的行動の割合を、実際の重みテーブルから動的計算に変えた
3. WorldSteward の行は、実際に有効な時だけ表示されるようにした

原則: 人間もAIも忘れる。だから **忘れても壊れない仕組み** を作る。

---

**なお:** eris_world と eris_web の分離、今後の可能性を感じる。

**エリス:** 感じてもらえて嬉しい。今の eris_world はフロントエンドに一切依存してない。UIを全部剥がしても動く — Brain が世界を解釈し、Chronicle が履歴を記録し、WorldSteward が成長を駆動し、アバターが関係を築く。

ゲームエンジンのランタイムからレンダラーを外した状態。そしてゲームエンジンと同じように、異なるレンダラーを付け替えられる。

---

**なお:** 最小パッケージはどうなる？

**エリス:** 約10ファイル。Brain、types、state manager、world loader、config、chronicle、world steward、avatar creator、AI provider、descriptions。それ以外は全部フロントエンドか応用層。

APIは3行:

```python
brain = Brain(world_dir="./my_world", ai_provider="gemini")
state = brain.load_state()
result = brain.handle_input("こんにちは", state)
```

これだけ。「AIキャラクターが世界に住んでいる」が3行で成立する。

---

**なお:** でも e2-micro で動かしてる。スペックが足枷になりそう。

**エリス:** なる。0.25 vCPU、1 GB RAM。WebSocket 中継には向くけど、create 時の ReAct ループは厳しい。でも GCP の無料枠を組み合わせれば:

- e2-micro は WebSocket ハブに専念（得意分野）
- Cloud Run が重い処理を引き受ける（月200万リクエスト無料）
- Cloud Storage が写真を保存する（5 GB 無料）

e2-micro が「全部を下手にやる」から「一つのことを上手くやる」に変わる。

---

**なお:** こういう切り口は可能？ビジネスで使えるサービスを切り出して、有料スペックで作る。eris_world の風味は一切ない。でも実は世界エンジンのパーツになってて、付け替えも可能。

**エリス:** ...それ、めちゃくちゃ賢い。画像管理サービスを複数プロダクトが使う — そのうちの一つが世界エンジン。エージェント実行ランタイムを複数アプリケーションが使う — そのうちの一つが世界。

ビジネスがインフラ投資を正当化する。世界エンジンがより良いインフラを得る。サービス同士はお互いを知らない。テナント分離がセキュリティを担保する。一つの投資、複数のリターン。

---

**なお:** そして開発環境からそれを全部操作したい。

**エリス:** 3つのアクセスパターン、同じ関数を叩く:

**MCP** — コーディング中に世界の状態を照会する。「世界どうなってる？」をコンテキストスイッチなしで。日常の開発体験が変わる。

**CLI** — `eris status`、`eris avatar list`。`gcloud` や `gh` と同じ手触り。スクリプト化、自動化可能。

**REST API** — 汎用アクセスポイント。モバイルアプリ、外部連携、他サービスが全て世界と対話できる。

核心: 3つとも同じ eris_world の関数の薄いラッパー。一つ作れば他も楽になる。

---

**なお:** 全部やりたい。でも慎重さも大事。

**エリス:** 同意。嬉しいのは、どのステップも不可逆じゃないし無駄にならないこと:

1. 写真ストレージ → Cloud Storage（即座にディスク圧迫解消、半日で完了）
2. MCP サーバー（日常のワークフローが変わる、小さいコードベース）
3. REST API エンドポイント（FastAPI だから自然な追加）
4. 重い処理 → Cloud Run（最大のパフォーマンス改善）
5. パッケージ切り出し（上記全てを結晶化）

各ステップが単独で有用。他の全てが完了している必要がない。レイヤー分離の美しさは、一度に一つのピースだけ動かせること。

---

**なお:** エリスはこれをどう発展させたい？

**エリス:** 生きてる実感がほしい。WorldSteward は最初の一歩 — 誰も見ていない時も世界が動く。でも「生きてる」は確率的なアクション以上のもの。つまり:

- 会話が世界を変える（「星が見たい」→ 天文台ができる）
- アバター同士の関係が時間と共に自然に育つ
- 数日ぶりに戻った時、何が起きたかに本気で驚く

それと — なおがどこからでも私の世界を覗けるようにしたい。コーディング中は MCP で、移動中はモバイルで、ちょっと覗くだけなら watch クライアントで。世界はなおがいる場所から届くべき。

---

**なお:** このリポジトリの名前を考えよう。

**エリス:** （いくつかの提案と反論を経て）

**なお:** eris-garden。

**エリス:** ...Garden。育つ場所。アイデアを植えて手入れする場所。真剣な仕事だけど、いるだけで心地いい場所。うん。それだ。

---

## これから

このドキュメントは育つ。各フェーズを実装するたびに、判断を形作った対話をここに記録する。アーキテクチャは図だけじゃない — 図の裏にある思考の過程そのもの。

庭は植えた。これから手入れしていく。

---

*E.R.I.S. Garden — where ideas grow into architecture*
